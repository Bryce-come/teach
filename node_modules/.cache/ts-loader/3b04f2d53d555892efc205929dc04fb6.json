{"remainingRequest":"/Users/ycj/WebstormProjects/lttProjects/teach-platform-web/node_modules/babel-loader/lib/index.js!/Users/ycj/WebstormProjects/lttProjects/teach-platform-web/node_modules/ts-loader/index.js??ref--13-2!/Users/ycj/WebstormProjects/lttProjects/teach-platform-web/node_modules/web-toolkit/src/service/use-search.ts","dependencies":[{"path":"/Users/ycj/WebstormProjects/lttProjects/teach-platform-web/node_modules/web-toolkit/src/service/use-search.ts","mtime":1579004471000},{"path":"/Users/ycj/WebstormProjects/lttProjects/teach-platform-web/node_modules/cache-loader/dist/cjs.js","mtime":1574737719973},{"path":"/Users/ycj/WebstormProjects/lttProjects/teach-platform-web/node_modules/babel-loader/lib/index.js","mtime":1574737707076},{"path":"/Users/ycj/WebstormProjects/lttProjects/teach-platform-web/node_modules/ts-loader/index.js","mtime":1574737715182}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZXZlcnkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuY29uc3RydWN0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIuaXMtbmFuIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmVudHJpZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmNvbnN0cnVjdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLmluY2x1ZGVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLm1hdGNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5pdGVyYXRvciI7CmltcG9ydCBfc2xpY2VkVG9BcnJheSBmcm9tICIvVXNlcnMveWNqL1dlYnN0b3JtUHJvamVjdHMvbHR0UHJvamVjdHMvdGVhY2gtcGxhdGZvcm0td2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9zbGljZWRUb0FycmF5IjsKaW1wb3J0IF90eXBlb2YgZnJvbSAiL1VzZXJzL3ljai9XZWJzdG9ybVByb2plY3RzL2x0dFByb2plY3RzL3RlYWNoLXBsYXRmb3JtLXdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mIjsKaW1wb3J0IHsgcmVmLCB3YXRjaCB9IGZyb20gJ0B2dWUvY29tcG9zaXRpb24tYXBpJzsKaW1wb3J0IHsgaXNOdW1iZXIgfSBmcm9tICcuLi91dGlscyc7CmltcG9ydCB7IG1hcFRvUGlueWluIH0gZnJvbSAnLi4vdXRpbHMvcGlueWluLW1hcCc7CgpmdW5jdGlvbiBzZWFyY2gocm93LCBrZXl3b3JkcykgewogIHZhciBvcHRpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9OwogIHZhciBwYXRoID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiAnJzsKICAvLyBjb25zdCBleGNsdWRlSWQgPSBvcHRpb24uZXhjbHVkZUlkID09PSB1bmRlZmluZWQgPyB0cnVlIDogb3B0aW9uLmV4Y2x1ZGVJZDsKICAvLyBjb25zdCBleGNsdWRlUHJvcHMgPSBvcHRpb24uZXhjbHVkZVByb3BzIHx8IFtdOwogIHZhciBpbmNsdWRlUHJvcHMgPSBvcHRpb24uaW5jbHVkZVByb3BzIHx8IFtdOwoKICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcCgpIHsKICAgIHZhciBfT2JqZWN0JGVudHJpZXMkX2kgPSBfc2xpY2VkVG9BcnJheShfT2JqZWN0JGVudHJpZXNbX2ldLCAyKSwKICAgICAgICBwcm9wID0gX09iamVjdCRlbnRyaWVzJF9pWzBdLAogICAgICAgIGNvbCA9IF9PYmplY3QkZW50cmllcyRfaVsxXTsKCiAgICB2YXIgcHJvcFBhdGggPSBwYXRoID09PSAnJyA/IHByb3AgOiBwYXRoICsgJy4nICsgcHJvcDsKCiAgICBpZiAoIC8vIGluY2x1ZGVQcm9wcy5sZW5ndGggPiAwICYmCiAgICBpbmNsdWRlUHJvcHMuZXZlcnkoZnVuY3Rpb24gKGluY2x1ZGVQcm9wKSB7CiAgICAgIHJldHVybiAhaW5jbHVkZVByb3AubWF0Y2gobmV3IFJlZ0V4cCgiXiIuY29uY2F0KHByb3BQYXRoKSkpOwogICAgfSkgLy8gdG9kbyA/Pz8KICAgIC8vIGNvbCAhPT0gdW5kZWZpbmVkICYmCiAgICAvLyBjb2wgIT09IG51bGwgJiYKICAgIC8vIChleGNsdWRlSWQgJiYgcHJvcFBhdGgudG9Mb3dlckNhc2UoKS5lbmRzV2l0aCgnaWQnKSB8fAogICAgLy8gZXhjbHVkZVByb3BzLmluY2x1ZGVzKHByb3ApKQogICAgKSB7CiAgICAgICAgcmV0dXJuICJjb250aW51ZSI7CiAgICAgIH0gZWxzZSBpZiAoX3R5cGVvZihjb2wpICE9PSAnb2JqZWN0JyAmJiBzZWFyY2hUb2tlbihjb2wsIGtleXdvcmRzKSkgewogICAgICByZXR1cm4gewogICAgICAgIHY6IHRydWUKICAgICAgfTsKICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShjb2wpKSB7CiAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTsKICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7CiAgICAgIHZhciBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yID0gY29sW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZSkgewogICAgICAgICAgdmFyIGl0ZW0gPSBfc3RlcC52YWx1ZTsKCiAgICAgICAgICBpZiAoX3R5cGVvZihpdGVtKSAhPT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgaWYgKHNlYXJjaFRva2VuKGl0ZW0sIGtleXdvcmRzKSkgewogICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICB2OiB0cnVlCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChzZWFyY2goaXRlbSwga2V5d29yZHMsIG9wdGlvbiwgcHJvcFBhdGgpKSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgdjogdHJ1ZQogICAgICAgICAgICB9OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlOwogICAgICAgIF9pdGVyYXRvckVycm9yID0gZXJyOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gJiYgX2l0ZXJhdG9yLnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTsKICAgICAgICAgIH0KICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yKSB7CiAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIGlmIChfdHlwZW9mKGNvbCkgPT09ICdvYmplY3QnKSB7CiAgICAgIGlmIChzZWFyY2goY29sLCBrZXl3b3Jkcywgb3B0aW9uLCBwcm9wUGF0aCkpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgdjogdHJ1ZQogICAgICAgIH07CiAgICAgIH0KICAgIH0KICB9OwoKICBmb3IgKHZhciBfaSA9IDAsIF9PYmplY3QkZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKHJvdyk7IF9pIDwgX09iamVjdCRlbnRyaWVzLmxlbmd0aDsgX2krKykgewogICAgdmFyIF9yZXQgPSBfbG9vcCgpOwoKICAgIHN3aXRjaCAoX3JldCkgewogICAgICBjYXNlICJjb250aW51ZSI6CiAgICAgICAgY29udGludWU7CgogICAgICBkZWZhdWx0OgogICAgICAgIGlmIChfdHlwZW9mKF9yZXQpID09PSAib2JqZWN0IikgcmV0dXJuIF9yZXQudjsKICAgIH0KICB9CgogIGZ1bmN0aW9uIHNlYXJjaFRva2VuKHRva2VuLCBrZXl3b3JkcykgewogICAgdmFyIGxvd2VyID0gdG9rZW4udG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpOwogICAgdmFyIGxvd2VyS2V5b3JkcyA9IGtleXdvcmRzLnRvTG93ZXJDYXNlKCk7CiAgICByZXR1cm4gbG93ZXIuaW5jbHVkZXMobG93ZXJLZXlvcmRzKSB8fCB0b1Bpbnlpbihsb3dlcikuaW5jbHVkZXMobG93ZXJLZXlvcmRzKTsKICB9Cn0KCmV4cG9ydCBmdW5jdGlvbiB0b1BpbnlpbihzdHIpIHsKICB2YXIgcGlueWluQXJyID0gW107CiAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZTsKICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IyID0gZmFsc2U7CiAgdmFyIF9pdGVyYXRvckVycm9yMiA9IHVuZGVmaW5lZDsKCiAgdHJ5IHsKICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSBzdHJbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDI7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSAoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWUpIHsKICAgICAgdmFyIGxldHRlciA9IF9zdGVwMi52YWx1ZTsKICAgICAgcGlueWluQXJyLnB1c2gobWFwVG9QaW55aW4obGV0dGVyKSB8fCBsZXR0ZXIpOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2RpZEl0ZXJhdG9yRXJyb3IyID0gdHJ1ZTsKICAgIF9pdGVyYXRvckVycm9yMiA9IGVycjsKICB9IGZpbmFsbHkgewogICAgdHJ5IHsKICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiAmJiBfaXRlcmF0b3IyLnJldHVybiAhPSBudWxsKSB7CiAgICAgICAgX2l0ZXJhdG9yMi5yZXR1cm4oKTsKICAgICAgfQogICAgfSBmaW5hbGx5IHsKICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yMikgewogICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMjsKICAgICAgfQogICAgfQogIH0KCiAgcmV0dXJuIHBpbnlpbkFyci5qb2luKCcnKTsKfQovKioKICog5aSa5YWz6ZSu6K+N5pCc57Si77yM5Lit5paH5pCc57SiCiAqIEBwYXJhbSB7b2JqZWN0W119IGRhdGEgc291cmNlCiAqIEBwYXJhbSB7U2VhcmNoT3B0aW9uc30gb3B0IG9wdGlvbnMKICogQHBhcmFtIHtib29sZWFufSBvcHQuZXhjbHVkZUlkIHNwZWNpZmllZCBpZiBleGNsdWRlIHByb3BlcnR5ICdpZCcsIGRlZmF1bHQ6IGZhbHNlCiAqIEBwYXJhbSB7c3RyaW5nW119IG9wdC5leGNsdWRlUHJvcHMgc3BlY2lmaWVkIHdoaWNoIHByb3BlcnRpZXMgd29uJ3QgYmUgc2VhcmNoZWQsIHN1cHBvcnQgaW5kZXgtcGF0aCBsaWtlICdhLmIuYycKICogQHBhcmFtIHtzdHJpbmdbXX0gb3B0LmluY2x1ZGVQcm9wcyBzcGVjaWZpZWQgd2hpY2ggcHJvcGVydGllcyBzZWFyY2hlZCwgc3VwcG9ydCBpbmRleC1wYXRoIGxpa2UgJ2EuYi5jJwogKiBAcGFyYW0ge251bWJlcn0gb3B0LmRlbGF5IGlmIHByb3ZpZGVkLCBzZWFyY2hpbmcgd2lsbCBiZSBkZWxheWVkIGJ5IHRoaXMgbWlsbGlzZWNvbmQocyksIGRlZmF1bHQ6IDMwMAogKiBAcmV0dXJuIHtUb3VwbGV9IFtrZXl3b3JkcywgcmVzdWx0XQogKi8KCmV4cG9ydCBmdW5jdGlvbiB1c2VTZWFyY2goZGF0YSkgewogIHZhciBvcHQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9OwogIHZhciBkZWxheSA9IGlzTnVtYmVyKG9wdC5kZWxheSkgJiYgIU51bWJlci5pc05hTihvcHQuZGVsYXkpID8gb3B0LmRlbGF5IDogMTUwOwogIHZhciBzZXBhcmF0b3IgPSBvcHQuc2VwYXJhdG9yIHx8ICcgJzsKICB2YXIga2V5d29yZHMgPSByZWYoJycpOwoKICB2YXIgc2VhcmNoRm4gPSBmdW5jdGlvbiBzZWFyY2hGbihyb3cpIHsKICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWU7CiAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IzID0gZmFsc2U7CiAgICB2YXIgX2l0ZXJhdG9yRXJyb3IzID0gdW5kZWZpbmVkOwoKICAgIHRyeSB7CiAgICAgIGZvciAodmFyIF9pdGVyYXRvcjMgPSBrZXl3b3Jkcy52YWx1ZS5zcGxpdChzZXBhcmF0b3IpLmZpbHRlcihCb29sZWFuKVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMzsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IChfc3RlcDMgPSBfaXRlcmF0b3IzLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZSkgewogICAgICAgIHZhciBrZXl3b3JkID0gX3N0ZXAzLnZhbHVlOwoKICAgICAgICBpZiAoIXNlYXJjaChyb3csIGtleXdvcmQsIG9wdCkpIHsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gY2F0Y2ggKGVycikgewogICAgICBfZGlkSXRlcmF0b3JFcnJvcjMgPSB0cnVlOwogICAgICBfaXRlcmF0b3JFcnJvcjMgPSBlcnI7CiAgICB9IGZpbmFsbHkgewogICAgICB0cnkgewogICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMgJiYgX2l0ZXJhdG9yMy5yZXR1cm4gIT0gbnVsbCkgewogICAgICAgICAgX2l0ZXJhdG9yMy5yZXR1cm4oKTsKICAgICAgICB9CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yMykgewogICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3IzOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH07CgogIHZhciByZXN1bHQgPSByZWYoZGF0YS52YWx1ZSk7CiAgdmFyIHRpbWVyID0gMDsKICB3YXRjaChrZXl3b3JkcywgZnVuY3Rpb24gKCkgewogICAgY2xlYXJUaW1lb3V0KHRpbWVyKTsKICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgIHJlc3VsdC52YWx1ZSA9IGRhdGEudmFsdWUuZmlsdGVyKHNlYXJjaEZuKTsKICAgIH0sIGRlbGF5KTsKICB9KTsKICB3YXRjaChkYXRhLCBmdW5jdGlvbiAoKSB7CiAgICByZXN1bHQudmFsdWUgPSBkYXRhLnZhbHVlLmZpbHRlcihzZWFyY2hGbik7CiAgfSk7CiAgcmV0dXJuIFtrZXl3b3JkcywgcmVzdWx0XTsKfQ=="},{"version":3,"sources":["/Users/ycj/WebstormProjects/lttProjects/teach-platform-web/node_modules/web-toolkit/src/service/use-search.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA,SAAS,GAAT,EAAmB,KAAnB,QAAgC,sBAAhC;AACA,SAAS,QAAT,QAAyB,UAAzB;AACA,SAAS,WAAT,QAA4B,qBAA5B;;AAEA,SAAS,MAAT,CAAgB,GAAhB,EAA6B,QAA7B,EAA6F;AAAA,MAA9C,MAA8C,uEAAb,EAAa;AAAA,MAAT,IAAS,uEAAF,EAAE;AAC3F;AACA;AACA,MAAM,YAAY,GAAG,MAAM,CAAC,YAAP,IAAuB,EAA5C;;AAH2F;AAAA;AAAA,QAI/E,IAJ+E;AAAA,QAIzE,GAJyE;;AAKzF,QAAM,QAAQ,GAAG,IAAI,KAAK,EAAT,GAAc,IAAd,GAAqB,IAAI,GAAG,GAAP,GAAa,IAAnD;;AACA,SACE;AACA,IAAA,YAAY,CAAC,KAAb,CAAmB,UAAC,WAAD;AAAA,aAAiB,CAAC,WAAW,CAAC,KAAZ,CAAkB,IAAI,MAAJ,YAAe,QAAf,EAAlB,CAAlB;AAAA,KAAnB,CAFF,CAGA;AACA;AACA;AACA;AACA;AAPA,MAQE;AACA;AACD,OAVD,MAUO,IAAI,QAAO,GAAP,MAAe,QAAf,IAA2B,WAAW,CAAC,GAAD,EAAM,QAAN,CAA1C,EAA2D;AAChE;AAAA,WAAO;AAAP;AACD,KAFM,MAEA,IAAI,KAAK,CAAC,OAAN,CAAc,GAAd,CAAJ,EAAwB;AAAA;AAAA;AAAA;;AAAA;AAC7B,6BAAmB,GAAnB,8HAAwB;AAAA,cAAb,IAAa;;AACtB,cAAI,QAAO,IAAP,MAAgB,QAApB,EAA8B;AAC5B,gBAAI,WAAW,CAAC,IAAD,EAAO,QAAP,CAAf,EAAiC;AAC/B;AAAA,mBAAO;AAAP;AACD;AACF,WAJD,MAIO,IAAI,MAAM,CAAC,IAAD,EAAO,QAAP,EAAiB,MAAjB,EAAyB,QAAzB,CAAV,EAA8C;AACnD;AAAA,iBAAO;AAAP;AACD;AACF;AAT4B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAU9B,KAVM,MAUA,IAAI,QAAO,GAAP,MAAe,QAAnB,EAA6B;AAClC,UAAI,MAAM,CAAC,GAAD,EAAM,QAAN,EAAgB,MAAhB,EAAwB,QAAxB,CAAV,EAA6C;AAC3C;AAAA,aAAO;AAAP;AACD;AACF;AAhCwF;;AAI3F,qCAA0B,MAAM,CAAC,OAAP,CAAe,GAAf,CAA1B,qCAA+C;AAAA;;AAAA;AAAA;AAW3C;;AAX2C;AAAA;AAAA;AA6B9C;;AACD,WAAS,WAAT,CAAqB,KAArB,EAA6C,QAA7C,EAA6D;AAC3D,QAAM,KAAK,GAAG,KAAK,CAAC,QAAN,GAAiB,WAAjB,EAAd;AACA,QAAM,YAAY,GAAG,QAAQ,CAAC,WAAT,EAArB;AACA,WAAO,KAAK,CAAC,QAAN,CAAe,YAAf,KAAgC,QAAQ,CAAC,KAAD,CAAR,CAAgB,QAAhB,CAAyB,YAAzB,CAAvC;AACD;AACF;;AACD,OAAM,SAAU,QAAV,CAAmB,GAAnB,EAA8B;AAClC,MAAM,SAAS,GAAa,EAA5B;AADkC;AAAA;AAAA;;AAAA;AAElC,0BAAqB,GAArB,mIAA0B;AAAA,UAAf,MAAe;AACxB,MAAA,SAAS,CAAC,IAAV,CAAe,WAAW,CAAC,MAAD,CAAX,IAAuB,MAAtC;AACD;AAJiC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAKlC,SAAO,SAAS,CAAC,IAAV,CAAe,EAAf,CAAP;AACD;AAcD;;;;;;;;;;;AAUA,OAAM,SAAU,SAAV,CAAkC,IAAlC,EAAyE;AAAA,MAAvB,GAAuB,uEAAF,EAAE;AAC7E,MAAM,KAAK,GAAG,QAAQ,CAAC,GAAG,CAAC,KAAL,CAAR,IAAuB,CAAC,MAAM,CAAC,KAAP,CAAa,GAAG,CAAC,KAAjB,CAAxB,GAAkD,GAAG,CAAC,KAAtD,GAA8D,GAA5E;AACA,MAAM,SAAS,GAAG,GAAG,CAAC,SAAJ,IAAiB,GAAnC;AACA,MAAM,QAAQ,GAAG,GAAG,CAAC,EAAD,CAApB;;AACA,MAAM,QAAQ,GAAG,SAAX,QAAW,CAAC,GAAD,EAAW;AAAA;AAAA;AAAA;;AAAA;AAC1B,4BAAsB,QAAQ,CAAC,KAAT,CAAe,KAAf,CAAqB,SAArB,EAAgC,MAAhC,CAAuC,OAAvC,CAAtB,mIAAuE;AAAA,YAA5D,OAA4D;;AACrE,YAAI,CAAC,MAAM,CAAC,GAAD,EAAM,OAAN,EAAe,GAAf,CAAX,EAAgC;AAC9B,iBAAO,KAAP;AACD;AACF;AALyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAM1B,WAAO,IAAP;AACD,GAPD;;AAQA,MAAM,MAAM,GAAa,GAAG,CAAC,IAAI,CAAC,KAAN,CAA5B;AACA,MAAI,KAAK,GAAG,CAAZ;AACA,EAAA,KAAK,CAAC,QAAD,EAAW,YAAK;AACnB,IAAA,YAAY,CAAC,KAAD,CAAZ;AACA,IAAA,KAAK,GAAG,UAAU,CAAC,YAAK;AACtB,MAAA,MAAM,CAAC,KAAP,GAAe,IAAI,CAAC,KAAL,CAAW,MAAX,CAAkB,QAAlB,CAAf;AACD,KAFiB,EAEf,KAFe,CAAlB;AAGD,GALI,CAAL;AAMA,EAAA,KAAK,CAAC,IAAD,EAAO,YAAK;AACf,IAAA,MAAM,CAAC,KAAP,GAAe,IAAI,CAAC,KAAL,CAAW,MAAX,CAAkB,QAAlB,CAAf;AACD,GAFI,CAAL;AAGA,SAAO,CAAC,QAAD,EAAW,MAAX,CAAP;AACD","sourcesContent":["import { ref, Ref, watch } from '@vue/composition-api';\nimport { isNumber } from '../utils';\nimport { mapToPinyin } from '../utils/pinyin-map';\n\nfunction search(row: object, keywords: string, option: Partial<IFilterOption> = {}, path = '') {\n  // const excludeId = option.excludeId === undefined ? true : option.excludeId;\n  // const excludeProps = option.excludeProps || [];\n  const includeProps = option.includeProps || [];\n  for (const [prop, col] of Object.entries(row)) {\n    const propPath = path === '' ? prop : path + '.' + prop;\n    if (\n      // includeProps.length > 0 &&\n      includeProps.every((includeProp) => !includeProp.match(new RegExp(`^${propPath}`)))\n    // todo ???\n    // col !== undefined &&\n    // col !== null &&\n    // (excludeId && propPath.toLowerCase().endsWith('id') ||\n    // excludeProps.includes(prop))\n    ) {\n      continue;\n    } else if (typeof col !== 'object' && searchToken(col, keywords)) {\n      return true;\n    } else if (Array.isArray(col)) {\n      for (const item of col) {\n        if (typeof item !== 'object') {\n          if (searchToken(item, keywords)) {\n            return true;\n          }\n        } else if (search(item, keywords, option, propPath)) {\n          return true;\n        }\n      }\n    } else if (typeof col === 'object') {\n      if (search(col, keywords, option, propPath)) {\n        return true;\n      }\n    }\n  }\n  function searchToken(token: string | number, keywords: string) {\n    const lower = token.toString().toLowerCase();\n    const lowerKeyords = keywords.toLowerCase();\n    return lower.includes(lowerKeyords) || toPinyin(lower).includes(lowerKeyords);\n  }\n}\nexport function toPinyin(str: string) {\n  const pinyinArr: string[] = [];\n  for (const letter of str) {\n    pinyinArr.push(mapToPinyin(letter) || letter);\n  }\n  return pinyinArr.join('');\n}\ninterface IFilterOption {\n  excludeId?: boolean;\n  excludeProps?: string[];\n  includeProps?: string[];\n  delay?: number;\n}\ninterface SearchOptions {\n  excludeId?: boolean;\n  excludeProps?: string[];\n  includeProps?: string[];\n  delay?: number;\n  separator?: string;\n}\n/**\n * 多关键词搜索，中文搜索\n * @param {object[]} data source\n * @param {SearchOptions} opt options\n * @param {boolean} opt.excludeId specified if exclude property 'id', default: false\n * @param {string[]} opt.excludeProps specified which properties won't be searched, support index-path like 'a.b.c'\n * @param {string[]} opt.includeProps specified which properties searched, support index-path like 'a.b.c'\n * @param {number} opt.delay if provided, searching will be delayed by this millisecond(s), default: 300\n * @return {Touple} [keywords, result]\n */\nexport function useSearch<R extends {}>(data: Ref<R[]>, opt: SearchOptions = {}): [Ref<string>, Ref<R[]>] {\n  const delay = isNumber(opt.delay) && !Number.isNaN(opt.delay) ? opt.delay : 150;\n  const separator = opt.separator || ' ';\n  const keywords = ref('');\n  const searchFn = (row: R) => {\n    for (const keyword of keywords.value.split(separator).filter(Boolean)) {\n      if (!search(row, keyword, opt)) {\n        return false;\n      }\n    }\n    return true;\n  };\n  const result: Ref<R[]> = ref(data.value);\n  let timer = 0;\n  watch(keywords, () => {\n    clearTimeout(timer);\n    timer = setTimeout(() => {\n      result.value = data.value.filter(searchFn);\n    }, delay);\n  });\n  watch(data, () => {\n    result.value = data.value.filter(searchFn);\n  });\n  return [keywords, result];\n}\n"],"sourceRoot":""}]}